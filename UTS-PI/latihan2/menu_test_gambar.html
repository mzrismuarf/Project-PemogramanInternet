<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- stylesheet -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/menu.css">
    <!-- script.js -->
    <script type="text/javascript" src="js/script.js"></script>
    <!-- light-slider.css untuk card menu -->
    <link rel="stylesheet" href="css/lightslider.css">
    <!-- Jquery -->
    <script type="text/javascript" src="js/Jquery.js"></script>
    <!-- lightsliders.js -->
    <script type="text/javascript" src="js/lightslider.js"></script>
    <style>
        /* Add your styles for the cart here */

        * {
            font-family: 'Poppins', sans-serif;
        }

        #cart {
            display: grid;
            position: fixed;
            align-items: center;
            justify-content: center;
            text-align: center;
            top: 70px;
            right: -300px;
            width: 250px;
            height: 50%;
            /* background-color: #fff; */
            background-color: #fffefe;
            box-shadow: 0px 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            transition: 0.3s;
            overflow-y: auto;
            /* overflow-y: scroll; */
            padding: 20px;
            z-index: 1000;
        }

        #cart.active {
            right: 0;
        }

        #cart img {
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-width: 80%;
            height: auto;
            margin-bottom: 10px;
            border-radius: 20px;
        }

        .cart-item {
            /* border-bottom: 1px solid #ccc; */
            width: 180px;
            border-radius: 20px;
            box-shadow: 0px 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        .delete-btn {
            color: #4D4D4D;
            cursor: pointer;
        }

        .delete-btn:hover {
            /* background-color: #EC3030;
            color: #FFFEFB; */
            color: #FFFEFB;
            background-color: #4D4D4D;
        }

        .edit-btn {
            color: #4D4D4D;
            cursor: pointer;
        }

        .edit-btn:hover {
            color: #FFFEFB;
            background-color: #4D4D4D;
        }

        span {

            padding: 7px;
        }

        .delete-btn,
        .edit-btn {
            /* display: flex; */
            border-radius: 15px;
        }

        #checkout-btn {

            background-color: #FFFEFB;
            color: #EC3030;
            border-radius: 20px;
            border: none;
            /* border: 1px solid #EC3030; */
        }

        #checkout-btn:hover {
            cursor: pointer;
            background-color: #EC3030;
            color: #FFFEFB;
        }
    </style>
</head>

<body>
    <header>
        <div class="logo">
            <img src="images/logo.png" alt="" width="100px">
            <h1>Sushi</h1>
        </div>
        <nav>
            <ul>
                <li><a href="/index.html" id="home">Home</a></li>
                <li><a href="/menu.html">Menu</a>
                    <ul class="dropdown">
                        <li><a href="/menu.html#lunch-menu">Lunch Menu</a></li>
                        <li><a href="/menu.html#dinner-menu">Dinner</a></li>
                        <li><a href="/menu.html#breakfast-menu">Breakfast</a></li>
                        <li><a href="/menu.html#catering-menu">Catering</a></li>
                    </ul>
                </li>
                <li><a href="/gallery.html">Gallery</a></li>
                <li><a href="/aboutous.html">About Us</a></li>
                <li><a href="#chart-btn">
                        <div class="btn-slider">
                            <!-- <i class="ri-shopping-cart-line">Cart</i> -->
                            <button id="chart-btn" class=" btn-cart"><i class="ri-shopping-cart-line"></i> Cart</button>
                        </div>
                    </a>
                </li>
            </ul>
        </nav>
    </header>
    <main>
        <section>
            <!-- <button id="checkout-btn" onclick="redirectToOrderPage()">Pesan Sekarang!</button> -->

            <div id="cart">
                <!-- Cart content will be dynamically added here using JavaScript -->
                <div id="cart-items"></div>
                <button id="checkout-btn" onclick="redirectToOrderPage()">Pesan Sekarang</button>
            </div>
            <div class="title-category" id="lunch-menu">
                <h1>Lunch menu</h1>
            </div>
            <div class="container-menu">
                <div class="container-menu-box">
                    <div class="box">
                        <!-- img box -->
                        <div class="slide-img">
                            <img src="images/menu/Lunch/SushiComboA/4.jpg" alt="">
                            <!-- overlayer -->
                            <div class="overlay">
                                <a href="#" class="overlay-buy-btn">Buy Now</a>
                            </div>
                        </div>
                        <!-- detail box -->
                        <div class="detail-box">
                            <!-- rating -->
                            <div class="rating">
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star-half checked"></span>
                                <span class="fa fa-star"></span>
                            </div>
                            <!-- type-->
                            <div class="type">
                                <a href="#">Sushi Combo A</a>
                                <p>8 nigiri and 1 maki roll</p>
                            </div>
                            <!-- price -->
                            <a href="" class="price">Rp. 23.00</a>
                        </div>
                    </div>
                    <div class="box">
                        <!-- img box -->
                        <div class="slide-img">
                            <img src="images/menu/Lunch/BentoBox/1.jpg" alt="">
                            <!-- overlayer -->
                            <div class="overlay">
                                <a href="#" class="overlay-buy-btn">Buy Now</a>
                            </div>
                        </div>
                        <!-- detail box -->
                        <div class="detail-box">
                            <!-- rating -->
                            <div class="rating">
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star-half checked"></span>
                                <span class="fa fa-star"></span>
                            </div>
                            <!-- type-->
                            <div class="type">
                                <a href="#">Bento Box</a>
                                <p>Assorted sushi, sashimi, tempura, and miso soup</p>
                            </div>
                            <!-- price -->
                            <a href="" class="price">Rp. 24.500</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const buyNowButtons = document.querySelectorAll('.overlay-buy-btn');
        const cart = document.getElementById('cart');
        const cartItemsContainer = document.getElementById('cart-items');
        const checkoutBtn = document.getElementById('checkout-btn');
        let totalQty = 0;
        let totalPrice = 0;

        updateCheckoutButtonVisibility();
        checkoutBtn.style.display = 'none';

        chartBtn.addEventListener('click', function () {
            cart.classList.toggle('active'); // Tambahkan ini
        });



        buyNowButtons.forEach(function (button) {
            button.addEventListener('click', function (event) {
                event.preventDefault();

                const parentBox = event.target.closest('.box');
                const imgSrc = parentBox.querySelector('.slide-img img').src;
                const title = parentBox.querySelector('.type a').innerText;
                const existingCartItem = getCartItemByTitle(title);

                if (existingCartItem) {
                    const inputQty = prompt(`Item "${title}" sudah ada di keranjang. Masukkan jumlah tambahan:`);
                    if (inputQty !== null) {
                        const qty = parseInt(inputQty) || 0;
                        if (qty > 0) {
                            updateCartItemQty(existingCartItem, qty);
                        }
                    }
                } else {
                    const inputQty = prompt(`Masukkan jumlah item "${title}":`);
                    if (inputQty !== null) {
                        const qty = parseInt(inputQty) || 0;
                        if (qty > 0) {
                            const price = parseFloat(parentBox.querySelector('.price').innerText.replace('Rp. ', ''));
                            addToCart(imgSrc, title, qty, price);
                        }
                    }
                }
            });
        });


        function getCartItemByTitle(title) {
            const cartItems = document.querySelectorAll('.cart-item');
            for (const cartItem of cartItems) {
                if (cartItem.querySelector('p').innerText === title) {
                    return cartItem;
                }
            }
            return null;
            updateCheckoutButtonVisibility();
        }


        function updateCheckoutButtonVisibility() {
            const checkoutBtn = document.getElementById('checkout-btn');
            const cartItemsContainer = document.getElementById('cart-items');

            const totalQty = cartItemsContainer.children.length;
            console.log("Total Qty:", totalQty);

            checkoutBtn.style.display = totalQty > 0 ? 'block' : 'none';
        }




        function addToCart(imgSrc, title, qty, price) {
            console.log("Adding to cart:", title);
            console.log("Total Qty:", totalQty);

            const cartItem = document.createElement('div');
            cartItem.classList.add('cart-item');

            // Perbarui properti data-img-src untuk menyimpan path gambar
            cartItem.dataset.imgSrc = imgSrc;

            cartItem.innerHTML = `
        <img src="${imgSrc}" alt="${title}" class="order-item-img">
        <p>${title}</p>
        <p class="qty">${qty}</p>
        <p class="price">Rp. ${(qty * price).toFixed(2)}</p>
        <span class="edit-btn" onclick="editCartItem(this)">Edit</span>
        <span class="delete-btn" onclick="removeCartItem(this)">Delete</span>
    `;

            cartItem.dataset.qty = qty;
            cartItem.dataset.price = price;

            cartItemsContainer.appendChild(cartItem);
            cart.classList.add('active');

            updateCheckoutButtonVisibility();

            totalQty += qty;
            totalPrice += qty * price;
            updateCartTotal();

            console.log("Number of items in cart:", cartItemsContainer.children.length);
            console.log("Item added to cart with imgSrc:", imgSrc);
        }

        function updateCartTotal() {
            const cartTotal = document.getElementById('cart-total');
            cartTotal.innerHTML = `Total Qty: ${totalQty}<br>Total Price: Rp. ${totalPrice.toFixed(2)}`;
            // updateCheckoutButtonVisibility();
        }

        // ... (fungsi-fungsi lainnya)


        // ... (fungsi-fungsi lainnya)
        function updateCartItemQty(cartItem, qty) {
            const qtyElement = cartItem.querySelector('.qty');
            qtyElement.innerText = `Qty: ${qty}`;

            const price = parseFloat(cartItem.dataset.price);
            const totalPriceForItem = qty * price;
            cartItem.querySelector('.price').innerText = `Price: Rp. ${totalPriceForItem.toFixed(2)}`;
            cart.classList.add('active');

            // Menghitung total qty dan total price secara keseluruhan
            totalQty = 0;
            totalPrice = 0;

            const cartItems = document.querySelectorAll('.cart-item');
            cartItems.forEach(function (item) {
                const itemQty = parseInt(item.dataset.qty);
                totalQty += itemQty;
                totalPrice += itemQty * parseFloat(item.dataset.price);
            });

            updateCartTotal();

            cartItem.dataset.qty = qty;
        }

        window.editCartItem = function (editBtn) {
            const cartItem = editBtn.closest('.cart-item');
            const title = cartItem.querySelector('p').innerText;
            const inputQty = prompt(`Edit jumlah item "${title}":`, cartItem.dataset.qty);
            const qty = inputQty ? parseInt(inputQty) : parseInt(cartItem.dataset.qty);

            if (qty > 0) {
                updateCartItemQty(cartItem, qty);
            } else {
                removeCartItem(cartItem);
            }

            // updateCheckoutButtonVisibility();
        };


        window.removeCartItem = function (deleteBtn) {
            const cartItem = deleteBtn.closest('.cart-item');
            cartItem.remove();

            const cartItems = document.querySelectorAll('.cart-item');
            if (cartItems.length === 0) {
                cart.classList.remove('active');
            }
            updateCheckoutButtonVisibility(); // Memanggil fungsi setelah menghapus item
        };

        window.redirectToOrderPage = function () {
            const orderData = [];

            const cartItems = document.querySelectorAll('.cart-item');
            cartItems.forEach(function (cartItem) {
                const title = cartItem.querySelector('p').innerText;
                const qty = parseInt(cartItem.dataset.qty);
                const price = parseFloat(cartItem.dataset.price);

                orderData.push({ title, qty, price });
            });

            // Menampilkan data di console
            console.log("Order Data:", orderData);
            console.log("Total Qty:", totalQty);
            console.log("Total Price:", totalPrice.toFixed(2));

            localStorage.setItem('orderData', JSON.stringify(orderData));
            localStorage.setItem('orderTotalQty', totalQty);
            localStorage.setItem('orderTotalPrice', totalPrice.toFixed(2));
            window.location.href = 'order.html';
        };



        // minimaze

        // end
    });
</script>

</html>