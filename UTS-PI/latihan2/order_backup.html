<!DOCTYPE html>
<html lang="en">

<head>
    <!-- head content... -->
    <link rel="stylesheet" href="css/order.css">
    <link rel="stylesheet" href="css/popup.css">
    <script type="text/javascript" src="js/popup.js"></script>


</head>

<body>
    <div class="overlay" id="overlay"></div>
    <div class="order-form">
        <h1>Order Form</h1>
        <form id="order-form">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>

            <label for="address">Address:</label>
            <textarea id="address" name="address" required></textarea>

            <label for="phone">Phone:</label>
            <input type="tel" id="phone" name="phone" required>

            <div id="order-items"></div>
            <p id="total-price">Total Price: Rp. 0.00</p>
            <!-- <button type="button" onclick="openPopup()">Place Order</button> -->
            <button type="button" onclick="validateAndPlaceOrder()">Place Order</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const orderItemsContainer = document.getElementById('order-items');
            const totalPriceElement = document.getElementById('total-price');
            const orderForm = document.getElementById('order-form');
            const orderData = JSON.parse(localStorage.getItem('orderData'));
            let totalPrice = 0;

            if (orderData) {
                orderData.forEach(function (item) {
                    const orderItem = document.createElement('div');
                    orderItem.classList.add('order-item');

                    const itemTotalPrice = item.qty * parseFloat(item.price);
                    totalPrice += itemTotalPrice;

                    orderItem.innerHTML = `
                        <img src="${item.imgSrc}" alt="${item.title}" class="order-item-img">
                        <p>${item.title}</p>
                        <p>Qty: ${item.qty}</p>
                        <p>Total Price: Rp. ${itemTotalPrice.toFixed(2)}</p>
                    `;

                    orderItemsContainer.appendChild(orderItem);
                });

                // Tampilkan total harga
                totalPriceElement.innerText = `Total Price: Rp. ${totalPrice.toFixed(2)}`;
            } else {
                // Redirect back to cart or handle as needed
                window.location.href = 'cart.html';
            }

            window.validateAndPlaceOrder = function () {
                const name = document.getElementById('name').value;
                const address = document.getElementById('address').value;
                const phone = document.getElementById('phone').value;

                if (name && address && phone) {
                    // Semua form terisi
                    showSuccessPopup();
                } else {
                    // Ada form yang belum terisi
                    showErrorPopup("Silahkan lengkapi form terlebih dahulu");
                }
            };


            function showSuccessPopup() {
                const orderData = JSON.parse(localStorage.getItem('orderData'));
                const name = document.getElementById('name').value;
                const address = document.getElementById('address').value;
                const phone = document.getElementById('phone').value;

                const popupContainer = document.createElement('div');
                popupContainer.classList.add('popup-container');

                const popupContent = document.createElement('div');
                popupContent.classList.add('popup-content');

                // Left side for form data
                const formDataContainer = document.createElement('div');
                formDataContainer.classList.add('form-data-container');
                formDataContainer.innerHTML = `
        <h2>Orderan Berhasil</h2>
        <p><strong>Name:</strong> ${name}</p>
        <p><strong>Address:</strong> ${address}</p>
        <p><strong>Phone:</strong> ${phone}</p>
    `;
                popupContent.appendChild(formDataContainer);

                // Right side for order items
                const orderItemsContainer = document.createElement('div');
                orderItemsContainer.classList.add('order-items-container');

                orderData.forEach(function (item) {
                    const itemTotalPrice = item.qty * parseFloat(item.price);

                    const popupItem = document.createElement('div');
                    popupItem.classList.add('popup-item');
                    popupItem.innerHTML = `
            <img src="${item.imgSrc}" alt="${item.title}" class="popup-item-img">
            <p>${item.title}</p>
            <p>Qty: ${item.qty}</p>
            <p>Total Price: Rp. ${itemTotalPrice.toFixed(2)}</p>
        `;

                    orderItemsContainer.appendChild(popupItem);
                });

                const totalPrice = orderData.reduce((acc, item) => acc + item.qty * parseFloat(item.price), 0);
                const totalContainer = document.createElement('p');
                totalContainer.textContent = `Total Price: Rp. ${totalPrice.toFixed(2)}`;

                orderItemsContainer.appendChild(totalContainer);
                popupContent.appendChild(orderItemsContainer);

                // Add close button
                const closeButton = document.createElement('button');
                closeButton.textContent = 'Close';
                closeButton.addEventListener('click', function () {
                    // Redirect to index.html
                    window.location.href = 'index.html';
                });
                popupContent.appendChild(closeButton);

                popupContainer.appendChild(popupContent);

                // Tampilkan pop-up sukses
                document.body.appendChild(popupContainer);
            }
        });

        // const totalPrice = orderData.reduce((acc, item) => acc + item.qty * parseFloat(item.price), 0);
        // const totalContainer = document.createElement('p');
        // totalContainer.textContent = `Total Price: Rp. ${totalPrice.toFixed(2)}`;

        // popupContent.appendChild(totalContainer);
        // popupContainer.appendChild(popupContent);

        // // Tampilkan pop-up sukses
        // document.body.appendChild(popupContainer);
        //     }

        // function showErrorPopup(message) {
        //     // Tampilkan pop-up gagal
        //     alert(`Orderan Gagal\n${message}`);
        // }


        // });



    </script>
</body>

</html>